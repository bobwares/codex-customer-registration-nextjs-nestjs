{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "<repo-root>/entity-specs/customer_domain-entities.json",
  "title": "customer_domain Domain Entities",
  "type": "object",
  "x-db": { "schema": "customer_domain" },
  "definitions": {
    "PostalAddress": {
      "type": "object",
      "properties": {
        "address_id": { "type": "integer" },
        "line1": { "type": "string", "maxLength": 255 },
        "line2": { "type": "string", "maxLength": 255 },
        "city": { "type": "string", "maxLength": 120 },
        "state": { "type": "string", "maxLength": 80 },
        "postal_code": { "type": "string", "maxLength": 20 },
        "country": { "type": "string", "minLength": 2, "maxLength": 2 },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" }
      },
      "required": [
        "address_id",
        "line1",
        "city",
        "state",
        "postal_code",
        "country",
        "created_at",
        "updated_at"
      ],
      "x-db": {
        "primaryKey": ["address_id"]
      }
    },
    "PrivacySettings": {
      "type": "object",
      "properties": {
        "privacy_settings_id": { "type": "integer" },
        "marketing_emails_enabled": { "type": "boolean" },
        "two_factor_enabled": { "type": "boolean" },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" }
      },
      "required": [
        "privacy_settings_id",
        "marketing_emails_enabled",
        "two_factor_enabled",
        "created_at",
        "updated_at"
      ],
      "x-db": {
        "primaryKey": ["privacy_settings_id"]
      }
    },
    "Customer": {
      "type": "object",
      "properties": {
        "customer_id": { "type": "string", "format": "uuid" },
        "name": { "type": "string", "maxLength": 255 },
        "first_name": { "type": "string", "maxLength": 120 },
        "middle_name": { "type": "string", "maxLength": 120 },
        "last_name": { "type": "string", "maxLength": 120 },
        "email": { "type": "string", "format": "email", "maxLength": 255 },
        "address_id": { "type": "integer" },
        "privacy_settings_id": { "type": "integer" },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" }
      },
      "required": [
        "customer_id",
        "name",
        "first_name",
        "last_name",
        "email",
        "created_at",
        "updated_at"
      ],
      "x-db": {
        "primaryKey": ["customer_id"],
        "foreignKey": [
          { "column": "address_id", "ref": "PostalAddress.address_id" },
          { "column": "privacy_settings_id", "ref": "PrivacySettings.privacy_settings_id" }
        ],
        "unique": [
          ["email"]
        ],
        "indexes": [
          ["address_id"],
          ["privacy_settings_id"]
        ]
      }
    },
    "CustomerEmail": {
      "type": "object",
      "properties": {
        "email_id": { "type": "integer" },
        "customer_id": { "type": "string", "format": "uuid" },
        "email": { "type": "string", "format": "email", "maxLength": 255 },
        "is_primary": { "type": "boolean" },
        "created_at": { "type": "string", "format": "date-time" }
      },
      "required": [
        "email_id",
        "customer_id",
        "email",
        "is_primary",
        "created_at"
      ],
      "x-db": {
        "primaryKey": ["email_id"],
        "foreignKey": { "column": "customer_id", "ref": "Customer.customer_id" },
        "unique": [
          ["customer_id", "email"]
        ],
        "indexes": [
          ["customer_id"]
        ]
      }
    },
    "CustomerPhoneNumber": {
      "type": "object",
      "properties": {
        "phone_id": { "type": "integer" },
        "customer_id": { "type": "string", "format": "uuid" },
        "type": { "type": "string", "maxLength": 20 },
        "number": { "type": "string", "maxLength": 20 },
        "extension": { "type": "string", "maxLength": 10 },
        "created_at": { "type": "string", "format": "date-time" }
      },
      "required": [
        "phone_id",
        "customer_id",
        "type",
        "number",
        "created_at"
      ],
      "x-db": {
        "primaryKey": ["phone_id"],
        "foreignKey": { "column": "customer_id", "ref": "Customer.customer_id" },
        "unique": [
          ["customer_id", "type", "number"]
        ],
        "indexes": [
          ["customer_id"]
        ]
      }
    },
    "CustomerProfileView": {
      "type": "object",
      "properties": {
        "customer_id": { "type": "string", "format": "uuid" },
        "name": { "type": "string", "maxLength": 255 },
        "first_name": { "type": "string", "maxLength": 120 },
        "middle_name": { "type": "string", "maxLength": 120 },
        "last_name": { "type": "string", "maxLength": 120 },
        "email": { "type": "string", "format": "email", "maxLength": 255 },
        "line1": { "type": "string", "maxLength": 255 },
        "line2": { "type": "string", "maxLength": 255 },
        "city": { "type": "string", "maxLength": 120 },
        "state": { "type": "string", "maxLength": 80 },
        "postal_code": { "type": "string", "maxLength": 20 },
        "country": { "type": "string", "minLength": 2, "maxLength": 2 },
        "marketing_emails_enabled": { "type": "boolean" },
        "two_factor_enabled": { "type": "boolean" }
      },
      "required": [
        "customer_id",
        "name",
        "email"
      ],
      "x-db": {
        "view": true,
        "name": "customer_profile_view"
      }
    }
  }
}
